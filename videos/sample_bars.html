<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Animated Horizontal Bar Chart</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #f4f4f4;
      margin: 0;
      font-family: Arial, sans-serif;
    }
    canvas {
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <canvas id="chart" width="800" height="500"></canvas>

  <script>
    const canvas = document.getElementById("chart");
    const ctx = canvas.getContext("2d");

    let bars = Array.from({length: 10}, (_, i) => ({
      label: `Item ${i+1}`,
      value: Math.floor(Math.random() * 100) + 10,
      currentValue: 0,
      targetValue: 0,
      y: 0
    }));

    // Sort ascending
    function sortBars() {
      bars.sort((a,b) => a.value - b.value);
    }

    // Draw chart
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const barHeight = 30;
      const gap = 15;
      const chartHeight = bars.length * (barHeight + gap);

      // Find max value for scaling
      const maxValue = Math.max(...bars.map(b => b.currentValue), 100);

      bars.forEach((bar, i) => {
        const y = 40 + i * (barHeight + gap);
        const width = (bar.currentValue / maxValue) * (canvas.width - 200);

        // Background bar
        ctx.fillStyle = "#e0e0e0";
        ctx.fillRect(150, y, canvas.width - 200, barHeight);

        // Animated bar
        ctx.fillStyle = "#4CAF50";
        ctx.fillRect(150, y, width, barHeight);

        // Label
        ctx.fillStyle = "#333";
        ctx.font = "16px Arial";
        ctx.textAlign = "right";
        ctx.fillText(bar.label, 140, y + barHeight/2 + 5);

        // Value with animation (count up/down)
        ctx.textAlign = "left";
        ctx.fillText(Math.round(bar.currentValue), 160 + width, y + barHeight/2 + 5);
      });
    }

    // Animation loop
    function animate() {
      let done = true;
      bars.forEach(bar => {
        // Smooth transition for bar length
        if (Math.abs(bar.currentValue - bar.value) > 0.5) {
          bar.currentValue += (bar.value - bar.currentValue) * 0.1;
          done = false;
        } else {
          bar.currentValue = bar.value;
        }
      });

      draw();
      requestAnimationFrame(animate);
    }

    // Update data
    function updateData() {
      bars.forEach(bar => {
        bar.value = Math.floor(Math.random() * 200) + 20;
      });
      sortBars();
    }

    // Start
    sortBars();
    animate();

    // Change data every 5 seconds
    setInterval(updateData, 5000);
  </script>
</body>
</html>
